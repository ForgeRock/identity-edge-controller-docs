<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="347px" preserveAspectRatio="none" style="width:605px;height:347px;" version="1.1" viewBox="0 0 605 347" width="605px" zoomAndPan="magnify"><defs><filter height="300%" id="fvlkpfufpyj60" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="450" x="78" y="23.5352">Authenticate an MQTT Client with an OAuth 2.0 Access Token</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="68.9766" y2="307.1504"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="252.5" x2="252.5" y1="68.9766" y2="307.1504"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="474" x2="474" y1="68.9766" y2="307.1504"/><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="8" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="15" y="54.0234">MQTT Client</text><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="8" y="306.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="15" y="326.6855">MQTT Client</text><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="165.5" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="172.5" y="54.0234">MQTT Broker (HiveMQ)</text><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="165.5" y="306.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="172.5" y="326.6855">MQTT Broker (HiveMQ)</text><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="243" x="351" y="33.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="229" x="358" y="54.0234">Authorization Server (ForgeRock)</text><rect fill="#FEFECE" filter="url(#fvlkpfufpyj60)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="243" x="351" y="306.1504"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="229" x="358" y="326.6855">Authorization Server (ForgeRock)</text><polygon fill="#A80036" points="462.5,96.2871,472.5,100.2871,462.5,104.2871,466.5,100.2871" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="468.5" y1="100.2871" y2="100.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="66.5" y="95.5449">Request access token (client credential flow)</text><polygon fill="#A80036" points="70.5,125.5977,60.5,129.5977,70.5,133.5977,66.5,129.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="473.5" y1="129.5977" y2="129.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="76.5" y="124.8555">Access token</text><polygon fill="#A80036" points="240.5,154.9082,250.5,158.9082,240.5,162.9082,244.5,158.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="59.5" x2="246.5" y1="158.9082" y2="158.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="66.5" y="154.166">Connect with access token</text><polygon fill="#A80036" points="462.5,184.2188,472.5,188.2188,462.5,192.2188,466.5,188.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252.5" x2="468.5" y1="188.2188" y2="188.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="259.5" y="183.4766">Request token verification keys</text><polygon fill="#A80036" points="263.5,213.5293,253.5,217.5293,263.5,221.5293,259.5,217.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="257.5" x2="473.5" y1="217.5293" y2="217.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="269.5" y="212.7871">Token verification keys</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="252.5" x2="294.5" y1="246.8398" y2="246.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="294.5" x2="294.5" y1="246.8398" y2="259.8398"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="253.5" x2="294.5" y1="259.8398" y2="259.8398"/><polygon fill="#A80036" points="263.5,255.8398,253.5,259.8398,263.5,263.8398,259.5,259.8398" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="259.5" y="242.0977">Validate access token</text><polygon fill="#A80036" points="70.5,285.1504,60.5,289.1504,70.5,293.1504,66.5,289.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64.5" x2="251.5" y1="289.1504" y2="289.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="76.5" y="284.4082">Connection success</text><!--
@startuml
Title Authenticate an MQTT Client with an OAuth 2.0 Access Token

participant "MQTT Client" as client
participant "MQTT Broker (HiveMQ)" as broker
participant "Authorization Server (ForgeRock)" as auth

client -> auth: Request access token (client credential flow)
auth -> client: Access token
client -> broker: Connect with access token
broker -> auth: Request token verification keys
auth -> broker: Token verification keys
broker -> broker: Validate access token
broker -> client: Connection success

@enduml

PlantUML version 1.2018.11(Sat Sep 22 17:43:53 BST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1136-b20
Operating System: Mac OS X
OS Version: 10.15.2
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>